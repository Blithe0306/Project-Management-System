<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="otp_rad_attr">
	<typeAlias alias="radAttrInfo"
		type="com.ft.otp.manager.confinfo.radius.entity.RadAttrInfo" />
		
	<parameterMap class="radAttrInfo" id="parameterMap_attr">
		<parameter property="attrType" javaType="int" jdbcType="INTEGER" />
		<parameter property="attrId" javaType="string" jdbcType="VARCHAR" />
		<parameter property="profileId" javaType="int" jdbcType="INTEGER" />
		<parameter property="attrName" javaType="string" jdbcType="VARCHAR" />
		<parameter property="attrValue" javaType="string" jdbcType="VARCHAR" />
		<parameter property="attrValueType" javaType="string" jdbcType="VARCHAR" />
		<parameter property="vendorid" javaType="int" jdbcType="INTEGER" />
		<parameter property="flag" javaType="int" jdbcType="INTEGER" />
	</parameterMap>
	
	<resultMap id="resultMap_attr" class="radAttrInfo">
		<result property="attrType" column="attrtype" />
		<result property="attrId" column="attrid" nullValue="" />
		<result property="profileId" column="profileid" nullValue="-1" />
		<result property="attrName" column="attrname" nullValue="" />
		<result property="attrValue" column="attrvalue" nullValue="" />
		<result property="attrValueType" column="valuetype" nullValue="" />
		<result property="vendorid" column="vendorid" nullValue="-1" />
	</resultMap>
	
	<sql id="queryFilter">
		<dynamic prepend="">
			<isNotNull property="attrId" prepend="and">
				<isNotEmpty property="attrId">
					attrid = #attrId#
				</isNotEmpty>
			</isNotNull>
		</dynamic>
		<dynamic prepend="">
			<isEqual property="flag" compareValue="1">
				<isNotNull property="vendorid" prepend="and">
					<isNotEmpty property="vendorid">
						vendorid = #vendorid#
					</isNotEmpty>
				</isNotNull>
			</isEqual>	
		</dynamic>
		<dynamic prepend="">
			<isNotEmpty property="profileId" prepend="and">
				<isNotEqual property="profileId" compareValue="-1">
					profileid = #profileId# 
				</isNotEqual>
			</isNotEmpty>
		</dynamic>
	</sql>
 
	
	<select id="countRadAttr" resultClass="int" parameterClass="radAttrInfo">
		<![CDATA[
	    	select count(*) from otppms_attrinfo WHERE 1=1
	    ]]>
	    <include refid="queryFilter" />
	</select>
	
	<insert id="addRadAttr" parameterClass="radAttrInfo">
		<![CDATA[
    		INSERT INTO otppms_attrinfo(attrtype, attrid, attrname, attrvalue, valuetype, profileid, vendorid)
    		VALUES(#attrType#,#attrId#,#attrName#,#attrValue#,#attrValueType#,#profileId#,#vendorid#)
    	]]>
	</insert>
	
	<select id="findRadAttr" resultMap="resultMap_attr"
		parameterClass="radAttrInfo">
		<![CDATA[
		    SELECT
    			attrtype, attrid, attrname, attrvalue, valuetype, profileid, vendorid
			from otppms_attrinfo WHERE 1=1 
         ]]>
		<include refid="queryFilter" />
	</select>
	
	<update id="updateRadAttr" parameterClass="radAttrInfo">
	     update 
	     	otppms_attrinfo 
	     set 
	     	attrtype=#attrType#,
	     	attrname=#attrName#,
	     	attrvalue=#attrValue#,  
	     	valuetype=#attrValueType#  
	     where 
	     	attrid=#attrId# and
	     	profileid=#profileId# and
	     	vendorid=#vendorid#
	     	
	</update>
	
	<delete id="deleteRadAttr" parameterClass="radAttrInfo">
		<![CDATA[
			DELETE FROM otppms_attrinfo WHERE 1=1 
		]]>
		<include refid="queryFilter" />
	</delete>

</sqlMap>
