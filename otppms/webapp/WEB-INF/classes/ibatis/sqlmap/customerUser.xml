<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="custom_user">
	<typeAlias alias="customerUser"
		type="com.ft.otp.manager.notice.customer.entity.CustomerUser" />

	<select id="queryCU" resultClass="customerUser"
		parameterClass="customerUser">
		<![CDATA[
		   select u.id,u.userid,u.projectid,a.email as useremail,a.adminid as realname  from otppms_cutomer_user u
		   left join otppms_admininfo a on a.adminid = u.userid
		  WHERE 1=1
        ]]>
		<dynamic prepend="">
			<isNotEmpty property="projectId" prepend="and">
				<isNotEqual property="projectId" compareValue="">
					u.projectid = #projectId#
				</isNotEqual>
			</isNotEmpty>
			<isNotEmpty property="userid" prepend="and">
				<isNotEqual property="userid" compareValue="">
					u.userid = #userid#
				</isNotEqual>
			</isNotEmpty>
		</dynamic>
	</select>

	<select id="findCU" resultClass="customerUser"
		parameterClass="customerUser">
		<![CDATA[
		   select u.id,u.userid,u.projectid,a.email as useremail,a.realname as realname  from otppms_cutomer_user u
		   left join otppms_admininfo a on a.adminid = u.userid
		  WHERE 1=1
        ]]>
		<dynamic prepend="">
			<isNotEmpty property="projectId" prepend="and">
				<isNotEqual property="projectId" compareValue="">
					u.projectid = #projectId#
				</isNotEqual>
			</isNotEmpty>
			<isNotEmpty property="userid" prepend="and">
				<isNotEqual property="userid" compareValue="">
					u.userid = #userid#
				</isNotEqual>
			</isNotEmpty>
		</dynamic>
	</select>

	<delete id="deleteCU" parameterClass="customerUser">
		<![CDATA[		   		    
			DELETE from otppms_cutomer_user WHERE 1=1 
        ]]>
		<dynamic prepend="">
			<isNotEmpty property="projectId" prepend="and">
				<isNotEqual property="projectId" compareValue="">
					projectid = #projectId#
				</isNotEqual>
			</isNotEmpty>
			<isNotEmpty property="userid" prepend="and">
				<isNotEqual property="userid" compareValue="">
					userid = #userid#
				</isNotEqual>
			</isNotEmpty>
		</dynamic>
	</delete>
	
	<update id="updateCU" parameterClass="customerUser">
		<![CDATA[		   		    
			update otppms_cutomer_user set projectid=#projectId# WHERE 1=1
        ]]>
        <dynamic prepend="">
			<isNotEmpty property="oldprojectId" prepend="and">
				<isNotEqual property="oldprojectId" compareValue="">
					projectId = #oldprojectId#
				</isNotEqual>
			</isNotEmpty>
		</dynamic>
	</update>

	<insert id="insertCU" parameterClass="customerUser">
		INSERT INTO otppms_cutomer_user (userid, projectid,useremail) VALUES
		(#userid#, #projectId#,#userEmail#);
	</insert>
</sqlMap>
